<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Angelina üå∏</title>
    <meta name="theme-color" content="#ffd6e0">
    <link rel="manifest" href="manifest.json">
    <style>
        :root {
            --pink: #ffd6e0;
            --dark-pink: #ff8fab;
            --white: #fff;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: var(--pink);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        h1, h2 { 
            color: #c9184a; 
            text-align: center;
            word-wrap: break-word;
        }
        section {
            background: var(--white);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: var(--shadow);
            width: 100%;
        }
        .button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        button {
            background: var(--dark-pink);
            color: var(--white);
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            flex: 1 0 auto;
            min-width: 120px;
            max-width: 200px;
        }
        button:hover { 
            opacity: 0.9;
            transform: scale(1.02);
        }
        .emoji-btn { 
            font-size: 20px; 
        }
        textarea, input {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        #baby-names-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #baby-names-list li {
            background: var(--pink);
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #baby-names-list li button {
            padding: 6px 10px;
            min-width: auto;
            max-width: none;
        }
        #random-message, #affirmation-text {
            font-style: italic;
            margin: 15px 0;
            color: #c9184a;
            min-height: 20px;
            text-align: center;
            font-size: 18px;
        }
        #mood-response {
            padding: 15px;
            margin-top: 15px;
            background-color: #ffe5ec;
            border-radius: 10px;
            text-align: center;
        }
        #notes-display {
            margin-top: 15px;
            padding: 15px;
            background-color: #ffe5ec;
            border-radius: 10px;
        }
        #install-btn {
            display: block;
            margin: 20px auto;
            width: 200px;
            text-align: center;
        }
        .hidden {
            display: none !important;
        }

        @media (max-width: 600px) {
            body {
                padding: 15px;
            }
            section {
                padding: 15px;
            }
            button {
                padding: 10px 15px;
                font-size: 14px;
                min-width: 100px;
            }
            h1 {
                font-size: 24px;
            }
            h2 {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <h1>üå∫ Hussam & Angelina's Love Sanctuary üå∫</h1>

    <!-- Mood Tracker -->
    <section id="mood-tracker">
        <h2>üåà How Are You Feeling Today, Angelina?</h2>
        <div class="button-container">
            <button class="emoji-btn" onclick="logMood('happy')">üòä Happy</button>
            <button class="emoji-btn" onclick="logMood('tired')">üò¥ Tired</button>
            <button class="emoji-btn" onclick="logMood('emotional')">ü•∫ Emotional</button>
            <button class="emoji-btn" onclick="logMood('excited')">üéâ Excited</button>
        </div>
        <div id="mood-response"></div>
    </section>

    <!-- Daily Affirmation -->
    <section id="daily-affirmation">
        <h2>üåπ Hussam's Daily Affirmation</h2>
        <div id="affirmation-text">"You're already the perfect mother to our baby."</div>
        <div class="button-container">
            <button onclick="newAffirmation()">Another One ‚û°Ô∏è</button>
        </div>
    </section>

    <!-- Surprise Button -->
    <section>
        <h2>üíñ Click for a Surprise from Hussam</h2>
        <div class="button-container">
            <button onclick="showRandomLove()">Open Love Jar üíå</button>
        </div>
        <p id="random-message"></p>
    </section>

    <!-- Shared Notes -->
    <section id="shared-notes">
        <h2>üìù Our Private Journal</h2>
        <textarea id="note-input" placeholder="Write a note for each other..." rows="4"></textarea>
        <div class="button-container">
            <button onclick="saveNote()">Save Note</button>
        </div>
        <div id="notes-display"></div>
    </section>

    <!-- Baby Names Ideas -->
    <section id="baby-names">
        <h2>üë∂ Baby Names We Love</h2>
        <input type="text" id="name-input" placeholder="Add a name...">
        <div class="button-container">
            <button onclick="addBabyName()">Add Name</button>
        </div>
        <ul id="baby-names-list"></ul>
    </section>

    <!-- Install as App Button -->
    <button id="install-btn" class="hidden">üì≤ Install as App</button>

    <script>
        // ===== MOOD TRACKER =====
        function logMood(mood) {
            const responses = {
                happy: [
                    "That smile of yours could power the sun. Keep glowing! ‚òÄÔ∏è",
                    "Tell me what's making you happy‚ÄîI want to savor this moment with you.",
                    "You're my favorite reason to celebrate. üéâ",
                    "Always be happy my beautiful angel"
                ],
                tired: [
                    "Let me draw you a bath tonight. You deserve it, habibti. üõÅ",
                    "I'll handle everything today. Just rest and grow our baby. üí§",
                    "Foot rub + your favorite show? Say the word. üë£",
                    "Theodore misses you.... me too!!"
                ],
                emotional: [
                    "Your tears are sacred. I'm here to hold them and you. ü§ó",
                    "Let's cuddle and talk‚Äîor just sit in silence. I'm here.",
                    "Pregnancy hormones are no joke. You're doing amazing."
                ],
                excited: [
                    "Your excitement is my favorite sound! Tell me all about it. üòÑ",
                    "We're one step closer to holding our little one! üéä",
                    "I love seeing you light up like this. What's on your mind?"
                ]
            };
            const randomResponse = responses[mood][Math.floor(Math.random() * responses[mood].length)];
            document.getElementById('mood-response').innerHTML = `
                <p><strong>Hussam says:</strong> ${randomResponse}</p>
            `;
        }

        // ===== DAILY AFFIRMATIONS =====
        const affirmations = [
            "I'm so proud to be your partner in this journey.",
            "You're my greatest adventure.",
            "However you feel today, I'm here‚Äîno conditions.",
            "I'll never stop cherishing the way you laugh.",
            "You're the strongest person I know.",
            "Did you know that Alex is Haywan?",
            "Thank you for carrying our baby so beautifully."
        ];
        
        function newAffirmation() {
            const randomAffirmation = affirmations[Math.floor(Math.random() * affirmations.length)];
            document.getElementById('affirmation-text').textContent = `"${randomAffirmation}"`;
        }

        // ===== SURPRISE BUTTON =====
        function showRandomLove() {
            const messages = [
                "I whispered your name in my prayers today.",
                "Ya xate ti, only little",
                "You're the strongest woman I know‚Äîcarrying our child like a warrior.",
                "Remember when we slow-danced in UAE? Let's do that tonight.",
                "I'd choose you in every lifetime.",
                "Your laugh is my favorite melody.",
                "You're already the perfect mother to our baby.",
                "I fell in love with you all over again every day.",
                "Theodore misses you.... me too!!",
                "Even on your worst days, you're still my dream come true."
            ];
            const randomMsg = messages[Math.floor(Math.random() * messages.length)];
            document.getElementById('random-message').textContent = randomMsg;
            
            if (typeof confetti === 'function') {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            }
        }

        // ===== SHARED NOTES =====
        function saveNote() {
            const note = document.getElementById('note-input').value;
            if (!note.trim()) return;
            
            try {
                const notes = JSON.parse(localStorage.getItem('loveNotes') || [];
                notes.push({ 
                    text: note, 
                    date: new Date().toLocaleDateString() 
                });
                localStorage.setItem('loveNotes', JSON.stringify(notes));
                displayNotes();
                document.getElementById('note-input').value = '';
            } catch (error) {
                console.error('Error saving note:', error);
            }
        }

        function displayNotes() {
            try {
                const notes = JSON.parse(localStorage.getItem('loveNotes') || '[]');
                let html = '';
                notes.forEach(note => {
                    html += `<p><strong>${note.date}:</strong> ${note.text}</p>`;
                });
                document.getElementById('notes-display').innerHTML = html || '<p>No notes yet. Write your first note!</p>';
            } catch (error) {
                console.error('Error displaying notes:', error);
            }
        }

        // ===== BABY NAMES =====
        function addBabyName() {
            const nameInput = document.getElementById('name-input');
            const name = nameInput.value.trim();
            
            if (!name) return;
            
            try {
                const names = JSON.parse(localStorage.getItem('babyNames') || '[]');
                if (names.includes(name)) {
                    alert('This name is already in the list!');
                    return;
                }
                
                names.push(name);
                localStorage.setItem('babyNames', JSON.stringify(names));
                displayBabyNames();
                nameInput.value = '';
                nameInput.focus();
            } catch (error) {
                console.error('Error adding baby name:', error);
            }
        }

        function displayBabyNames() {
            try {
                const names = JSON.parse(localStorage.getItem('babyNames') || '[]');
                let html = '';
                
                names.forEach(name => {
                    // Escape quotes to prevent XSS and ensure proper string handling
                    const safeName = name.replace(/"/g, '&quot;');
                    html += `<li>${name} <button onclick="removeName('${safeName}')">‚ùå</button></li>`;
                });
                
                document.getElementById('baby-names-list').innerHTML = html || '<li>No names added yet</li>';
            } catch (error) {
                console.error('Error displaying baby names:', error);
            }
        }

        function removeName(name) {
            try {
                let names = JSON.parse(localStorage.getItem('babyNames') || '[]');
                names = names.filter(n => n !== name);
                localStorage.setItem('babyNames', JSON.stringify(names));
                displayBabyNames();
            } catch (error) {
                console.error('Error removing name:', error);
            }
        }

        // ===== PWA INSTALLATION =====
        let deferredPrompt;

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('install-btn').classList.remove('hidden');
        });

        document.getElementById('install-btn').addEventListener('click', async () => {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to the install prompt: ${outcome}`);
            deferredPrompt = null;
        });

        // ===== SERVICE WORKER REGISTRATION =====
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        // Initialize displays on load
        document.addEventListener('DOMContentLoaded', () => {
            displayNotes();
            displayBabyNames();
        });
    </script>

    <!-- Confetti.js -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</body>
</html>
