<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Angelina's Love Sanctuary 💗</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ff8fab" />
  <style>
    /* Your CSS styles remain unchanged */
    body { font-family: Arial, sans-serif; background: #ffd6e0; color: #333; max-width: 800px; margin: auto; padding: 20px; }
    h1,h2 { color: #c9184a; text-align: center; }
    section { background: #fff; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    .btns { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
    button { background: #ff8fab; border: none; color: white; padding: 10px 20px; border-radius: 25px; font-size: 16px; cursor: pointer; transition: 0.3s; }
    button:hover { transform: scale(1.05); opacity: 0.9; }
    input, textarea { width: 100%; padding: 10px; margin-top: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
    #output,#mood-response,#pregnancy-info,#baby-names-list,#note-list,#mood-list { background: #ffe5ec; border-radius: 8px; padding: 15px; margin-top: 10px; color: #c9184a; }
    ul { list-style: none; padding: 0; }
    li { background: #ffd6e0; padding: 10px; margin-bottom: 5px; border-radius: 5px; display:flex; justify-content: space-between; align-items: center; }
    li button { font-size:12px; background:#c9184a; color:white; border:none; border-radius:5px; padding:4px 8px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>💌 Angelina’s Love Sanctuary</h1>

  <!-- Mood Tracker -->
  <section>
    <h2>🧘 How are you feeling today?</h2>
    <div class="btns">
      <button onclick="logMood('happy')">😊 Happy</button>
      <button onclick="logMood('relaxed')">🌿 Relaxed</button>
      <button onclick="logMood('tired')">😩 Tired</button>
      <button onclick="logMood('sleepy')">😴 Sleepy</button>
    </div>
    <div id="mood-response"></div>
    <div id="mood-list"></div>
  </section>

  <!-- Pregnancy Tracker -->
  <section>
    <h2>🤰 Pregnancy Timeline</h2>
    <div id="pregnancy-info"></div>
  </section>

  <!-- Baby Names -->
  <section>
    <h2>👶 Baby Name Ideas</h2>
    <input type="text" id="name-input" placeholder="Suggest a name..." />
    <div class="btns">
      <button onclick="addBabyName()">Add Name</button>
    </div>
    <div id="baby-names-list"></div>
  </section>

  <!-- Love Notes -->
  <section>
    <h2>💖 Love Notes</h2>
    <textarea id="note-input" placeholder="Write something sweet..." rows="4"></textarea>
    <div class="btns">
      <button onclick="saveNote()">Save Note</button>
    </div>
    <div id="note-list"></div>
  </section>

  <!-- Surprise Jar -->
  <section>
    <h2>🎁 Surprise from Hussam</h2>
    <div class="btns">
      <button onclick="showMessage()">Show Me Love</button>
    </div>
    <div id="output"></div>
  </section>

  <!-- Firebase Compat Libraries -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

  <script>
    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDWIloLcFrlLTkNBDn0XZsOhpdyATjGDGo",
      authDomain: "angelinalovehuss.firebaseapp.com",
      projectId: "angelinalovehuss",
      storageBucket: "angelinalovehuss.firestore.app",
      messagingSenderId: "776961218617",
      appId: "1:776961218617:web:33cdb0340f4c72e61ad5e8"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Pregnancy tracker logic
    const LMP_DATE = new Date("2025-03-14T00:00:00");
    const DUE_DATE = new Date(LMP_DATE.getTime() + 280 * 24*60*60*1000);
    const WEEKLY_FACTS = {12:["🍑 ..."],13:["🧠 ..."],14:["🍋 ..."]};
    function updatePregnancy(){
      const days = Math.floor((new Date()-LMP_DATE)/(1000*60*60*24));
      const weeks = Math.floor(days/7), rem=days%7;
      const facts=WEEKLY_FACTS[weeks]||["No facts yet."];
      document.getElementById('pregnancy-info').innerHTML=`
        <p>📅 Due Date: <strong>${DUE_DATE.toDateString()}</strong></p>
        <p>⏳ You are <strong>${weeks}w ${rem}d</strong> pregnant.</p>
        <ul>${facts.map(f=>`<li>${f}</li>`).join('')}</ul>`;
    }

    // Shared collections
    const notesCol = db.collection("notes");
    const moodsCol = db.collection("moods");
    const namesCol = db.collection("babyNames");

    // Surprises
    const surpriseMessages = ["I kiss...","You're carrying...","Let’s dance..."];

    function showMessage(){
      const msg = surpriseMessages[Math.floor(Math.random()*surpriseMessages.length)];
      document.getElementById('output').textContent=msg;
      confetti({particleCount:100, spread:70});
    }

    // SAVE & PRUNE NOTES
    async function saveNote(){
      const text=note-input.value.trim();
      if(!text)return;
      await notesCol.add({text, date:Date.now()});
      prune(notesCol, 6);
    }
    async function deleteNote(id){ await notesCol.doc(id).delete(); }
    function renderNotes(snapshot){
      const arr = snapshot.docs.map(d=>({id:d.id,...d.data()}))
         .sort((a,b)=>b.date-a.date);
      note-list.innerHTML = arr.length
        ? '<ul>'+arr.map(n=>`<li>${new Date(n.date).toLocaleDateString()}: ${n.text} <button onclick="deleteNote('${n.id}')">🗑</button></li>`).join('')+'</ul>'
        : "<p>No notes yet.</p>";
    }

    // SALE & PRUNE MOODS
    const moodMessages = {happy:["Joyful"],relaxed:["Calm"],tired:["Tired"],sleepy:["Sleepy"]};
    async function logMood(m){
      const text=moodMessages[m][0];
      document.getElementById('mood-response').textContent=text;
      await moodsCol.add({ mood:m, date:Date.now() });
      prune(moodsCol, 6);
    }
    async function deleteMood(id){ await moodsCol.doc(id).delete(); }
    function renderMoods(snapshot){
      const arr = snapshot.docs.map(d=>d.data()).sort((a,b)=>b.date-a.date);
      mood-list.innerHTML = arr.length
        ? '<ul>'+arr.map(m=>`<li>${new Date(m.date).toLocaleString()}: ${m.mood}</li>`).join('')+'</ul>'
        : "<p>No moods yet.</p>";
    }

    // BABY NAMES
    async function addBabyName(){
      const name = name-input.value.trim();
      if(!name)return;
      await namesCol.add({ name, date:Date.now() });
      name-input.value="";
    }
    async function deleteBabyName(id){ await namesCol.doc(id).delete(); }
    function renderNames(snapshot){
      const arr = snapshot.docs.map(d=>({id:d.id,...d.data()}))
         .sort((a,b)=>b.date-a.date);
      baby-names-list.innerHTML = arr.length
        ? '<ul>'+arr.map(n=>`<li>${n.name}<button onclick="deleteBabyName('${n.id}')">🗑</button></li>`).join('')+'</ul>'
        : "<p>No names yet.</p>";
    }

    // PRUNE HELPER
    async function prune(col, max){
      const snap = await col.orderBy('date','desc').get();
      const docs = snap.docs;
      for(let i=max; i<docs.length; i++){
        await docs[i].ref.delete();
      }
    }

    // LISTEN & RENDER
    notesCol.onSnapshot(renderNotes);
    moodsCol.onSnapshot(renderMoods);
    namesCol.onSnapshot(renderNames);

    window.onload = ()=>{
      updatePregnancy();
      navigator.serviceWorker&&navigator.serviceWorker.register('sw.js');
    };
  </script>
</body>
</html>
